"use strict";(globalThis["webpackChunkfront"]=globalThis["webpackChunkfront"]||[]).push([[413],{3413:(e,a,o)=>{o.r(a),o.d(a,{default:()=>w});var l=o(9835);const t=(0,l._)("div",{class:"text-h6"},"Reportes del Sistema",-1),s={class:"row q-col-gutter-md q-mt-sm"},i={class:"col-12 col-md-4"},r={class:"col-12 col-md-2"},n={class:"col-12 col-md-2"},c={class:"col-12 col-md-2"},d={class:"col-12 col-md-2 flex flex-center"};function m(e,a,o,m,u,p){const f=(0,l.up)("q-select"),h=(0,l.up)("q-input"),b=(0,l.up)("q-btn"),g=(0,l.up)("q-card-section"),v=(0,l.up)("q-card"),D=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(D,{class:"q-pa-md"},{default:(0,l.w5)((()=>[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[t,(0,l._)("div",s,[(0,l._)("div",i,[(0,l.Wm)(f,{modelValue:u.filtros.tipo,"onUpdate:modelValue":a[0]||(a[0]=e=>u.filtros.tipo=e),options:u.tipos,label:"Tipo de Reporte",outlined:"",dense:"","emit-value":"","map-options":""},null,8,["modelValue","options"])]),(0,l._)("div",r,[(0,l.Wm)(h,{modelValue:u.filtros.fechaDesde,"onUpdate:modelValue":a[1]||(a[1]=e=>u.filtros.fechaDesde=e),type:"date",label:"Fecha Desde",outlined:"",dense:""},null,8,["modelValue"])]),(0,l._)("div",n,[(0,l.Wm)(h,{modelValue:u.filtros.fechaHasta,"onUpdate:modelValue":a[2]||(a[2]=e=>u.filtros.fechaHasta=e),type:"date",label:"Fecha Hasta",outlined:"",dense:""},null,8,["modelValue"])]),(0,l._)("div",c,[(0,l.Wm)(f,{modelValue:u.filtros.formato,"onUpdate:modelValue":a[3]||(a[3]=e=>u.filtros.formato=e),options:u.formatos,label:"Formato",outlined:"",dense:"","emit-value":"","map-options":""},null,8,["modelValue","options"])]),(0,l._)("div",d,[(0,l.Wm)(b,{label:"Buscar",color:"primary",icon:"search",onClick:p.generarReporte,loading:u.loading},null,8,["onClick","loading"])])])])),_:1})])),_:1})])),_:1})}o(4641),o(3269);var u=o(3878),p=o.n(u);const f={name:"ReportePage",data(){return{filtros:{tipo:"minerales-asociado",fechaDesde:p()().subtract(1,"month").format("YYYY-MM-DD"),fechaHasta:p()().format("YYYY-MM-DD"),formato:"xlsx"},tipos:[{label:"Minerales por Asociado",value:"minerales-asociado"},{label:"Tornaguías Emitidas",value:"tornaguias-emitidas"},{label:"Almacenamiento y Tratamiento",value:"almacenamiento-tratamiento"},{label:"Entregas a Comercializadoras",value:"entregas-comercializadoras"},{label:"Vehículos y Choferes",value:"vehiculos-choferes"},{label:"Producción Mensual",value:"produccion-mensual"},{label:"Control Documental",value:"control-documental"},{label:"Consolidado Dirección",value:"consolidado-direccion"}],formatos:[{label:"Excel (.xlsx)",value:"xlsx"},{label:"PDF (.pdf)",value:"pdf"}],loading:!1}},methods:{generarReporte(){if(!this.filtros.tipo)return void this.$q.notify({type:"warning",message:"Seleccione el tipo de reporte"});this.loading=!0;const e={fechaDesde:this.filtros.fechaDesde,fechaHasta:this.filtros.fechaHasta,format:this.filtros.formato},a="https://bsanpablo.tuprogam.com/api/",o=`${a}reportes/${this.filtros.tipo}`,l=localStorage.getItem("token");this.$axios({url:o,method:"GET",params:e,headers:{Authorization:`Bearer ${l}`,"Content-Type":"application/json"},responseType:"blob"}).then((e=>{const a=new Blob([e.data]),o=document.createElement("a");o.href=URL.createObjectURL(a),o.download=`${this.filtros.tipo}.${this.filtros.formato}`,o.click(),URL.revokeObjectURL(o.href)})).catch((()=>{this.$q.notify({type:"negative",message:"Error al generar el reporte"})})).finally((()=>{this.loading=!1}))}}};var h=o(1639),b=o(9885),g=o(4458),v=o(3190),D=o(7887),V=o(6611),y=o(8879),q=o(9984),x=o.n(q);const C=(0,h.Z)(f,[["render",m]]),w=C;x()(f,"components",{QPage:b.Z,QCard:g.Z,QCardSection:v.Z,QSelect:D.Z,QInput:V.Z,QBtn:y.Z})}}]);